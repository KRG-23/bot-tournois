FROM node:20-slim
RUN apt-get update && apt-get install -y openssl
WORKDIR /workspace
COPY package*.json tsconfig.base.json ./
COPY apps/api/package.json apps/api/tsconfig.json /workspace/apps/api/
# copy core sources so the build can run inside image
COPY packages/core /workspace/packages/core/
RUN npm install && npm run build --workspace packages/core
CMD ["npm", "--workspace", "apps/api", "run", "dev"]
